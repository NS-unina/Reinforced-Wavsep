import csv
import sys


def usage():
    print("[-] Usage: extract_single_for_each_vulnerability.py <csv>")

if __name__ == "__main__":
    if len(sys.argv) != 2:
        usage()


    csv_file = sys.argv[1]
    output_file = 'noduplicates.csv'
    unique_rows = set()
    with open(csv_file) as f:
        reader = csv.reader(f)
        header = next(reader)
        for row in reader:
            if row[0] not in [r[0] for r in unique_rows]:
                unique_rows.add(tuple(row))

    with open(output_file, 'w', newline='') as outfile:
        writer = csv.writer(outfile)
        writer.writerow(header)
        for row in unique_rows:
            writer.writerow(row)


        


